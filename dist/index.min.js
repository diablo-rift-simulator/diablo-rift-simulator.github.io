!function(){"use strict";let h=0,i=!1,j=0,k=0,l=[],m={"1":{"gem/trickshot_gem":{name:"Trickshot Gem",amount:0},"gem/everlasting_torment":{name:"Everlasting Torment",amount:0},"gem/the_black_rose":{name:"The Black Rose",amount:0},"gem/chained_death":{name:"Chained Death",amount:0},"gem/berserkers_eye":{name:"Berserker's Eye",amount:0},"gem/mocking_laughter":{name:"Mocking Laughter",amount:0},"gem/zod_stone":{name:"Zod Stone",amount:0},"gem/caarsens_invigoration":{name:"Caarsen's Invigoration",amount:0},"gem/defiant_soul":{name:"Defiant soul",amount:0},"gem/freedom_and_devotion":{name:"Freedom and Devotion",amount:0},"gem/respite_stone":{name:"Respite Stone",amount:0},"gem/seleds_weakening":{name:"Seled's Weakening",amount:0},"gem/pain_of_subjugation":{name:"Pain of Subjugation",amount:0},"gem/nightmare_wreath":{name:"Nightmare Wreath",amount:0}},"2":{"gem/power_and_command":{name:"Power & Command",amount:0},"gem/the_hunger":{name:"The Hunger",amount:0},"gem/bloody_reach":{name:"Bloody Reach",amount:0},"gem/cutthroats_grin":{name:"Cutthroats Grin",amount:0},"gem/lightning_core":{name:"Lighting Core",amount:0},"gem/followers_burden":{name:"Followers Burden",amount:0},"gem/unity_crystal":{name:"Unity Crystal",amount:0},"gem/battleguard":{name:"Battleguard",amount:0}},"2_5":{"gem/bottled_hope":{name:"Bottled Hope",amount:0},"gem/phoenix_ashes":{name:"Phoenix Ashes",amount:0},"gem/bsj":{name:"Blood-Soaked Jade",amount:0},"gem/chip_of_stoned_flesh":{name:"Chip of Stoned Flesh",amount:0},"gem/echoing_shade":{name:"Echoing Shade",amount:0},"gem/howlers_call":{name:"Howlers Call",amount:0},"gem/zwensons_haunting":{name:"Zwenson's Haunting",amount:0},"gem/seeping_bile":{name:"Seeping Bile",amount:0},"gem/blessing_of_the_worthy":{name:"Blessing of the Worthy",amount:0}},"3_5":{"gem/bottled_hope":{name:"Bottled Hope",amount:0},"gem/phoenix_ashes":{name:"Phoenix Ashes",amount:0},"gem/bsj":{name:"Blood-Soaked Jade",amount:0},"gem/chip_of_stoned_flesh":{name:"Chip of Stoned Flesh",amount:0},"gem/echoing_shade":{name:"Echoing Shade",amount:0},"gem/howlers_call":{name:"Howlers Call",amount:0},"gem/zwensons_haunting":{name:"Zwenson's Haunting",amount:0},"gem/seeping_bile":{name:"Seeping Bile",amount:0},"gem/blessing_of_the_worthy":{name:"Blessing of the Worthy",amount:0}},"4_5":{"gem/bottled_hope":{name:"Bottled Hope",amount:0},"gem/phoenix_ashes":{name:"Phoenix Ashes",amount:0},"gem/bsj":{name:"Blood-Soaked Jade",amount:0},"gem/chip_of_stoned_flesh":{name:"Chip of Stoned Flesh",amount:0},"gem/echoing_shade":{name:"Echoing Shade",amount:0},"gem/howlers_call":{name:"Howlers Call",amount:0},"gem/zwensons_haunting":{name:"Zwenson's Haunting",amount:0},"gem/seeping_bile":{name:"Seeping Bile",amount:0},"gem/blessing_of_the_worthy":{name:"Blessing of the Worthy",amount:0}},"5_5":{"gem/bottled_hope":{name:"Bottled Hope",amount:0},"gem/phoenix_ashes":{name:"Phoenix Ashes",amount:0},"gem/bsj":{name:"Blood-Soaked Jade",amount:0},"gem/chip_of_stoned_flesh":{name:"Chip of Stoned Flesh",amount:0},"gem/echoing_shade":{name:"Echoing Shade",amount:0},"gem/howlers_call":{name:"Howlers Call",amount:0},"gem/zwensons_haunting":{name:"Zwenson's Haunting",amount:0},"gem/seeping_bile":{name:"Seeping Bile",amount:0},"gem/blessing_of_the_worthy":{name:"Blessing of the Worthy",amount:0}}},n=0,o={"1":0,"2":0,"2_5":0,"3_5":0,"4_5":0,"5_5":0},p=[1,2,5],q=[.754,.201,.045],r=[2,3,4,5],s=[.75,.2,.04,.01],t=["gem/trickshot_gem","gem/the_black_rose","gem/everlasting_torment","gem/chained_death","gem/berserkers_eye","gem/mocking_laughter","gem/zod_stone","gem/caarsens_invigoration","gem/defiant_soul","gem/freedom_and_devotion","gem/nightmare_wreath","gem/respite_stone","gem/seleds_weakening","gem/pain_of_subjugation",],u=["gem/power_and_command","gem/the_hunger","gem/bloody_reach","gem/cutthroats_grin","gem/lightning_core","gem/battleguard","gem/followers_burden","gem/unity_crystal",],v=["gem/bottled_hope","gem/phoenix_ashes","gem/bsj","gem/chip_of_stoned_flesh","gem/echoing_shade","gem/howlers_call","gem/zwensons_haunting","gem/seeping_bile","gem/blessing_of_the_worthy",],d=document.querySelectorAll(".door"),w=$("#five-star-count-main"),x=$("#consume-all-gems"),y=$("#money-spent"),z=$(".resonance"),A=$(".gem-power"),B=$("#gem-info-modal");async function e(){for(let a of((h+=25)%125==0&&(i=!0),y.text(h),g(!1),await d.forEach(b=>{let a=$(".boxes",b),c=parseInt(a.css("transitionDuration"));return a.css("transform","translateY(0)"),new Promise(a=>{setTimeout(a,100*c)})}),d))await new Promise(b=>{setTimeout(b,1),$("#stars",$(a).parent()).css("display","grid")})}async function f(){let a=o["5_5"];for(;o["5_5"]===a;)await e()}function g(a=!0){d.forEach(b=>{{let i=b.querySelector(".boxes"),c=i.cloneNode(!1),f=[].concat(t,u,v).sort(()=>.5-Math.random());a&&f.unshift("crest");let d={};c.setAttribute("selected-gem","none"),a||(d=E(),F(d),f.push(d.name),c.setAttribute("selected-gem",d.name),c.addEventListener("transitionstart",function(){this.querySelectorAll(".box").forEach(a=>{a.style.filter="blur(1px)"})},{once:!0}),c.addEventListener("transitionend",function(){this.querySelectorAll(".box").forEach((a,b)=>{a.style.filter="blur(0)",b>0&&this.removeChild(a)})},{once:!0}));for(let h=f.length-1;h>=0;h--){let g=document.createElement("div");g.classList.add("box"),g.style.width=b.clientWidth+"px",g.style.height=b.clientHeight+"px",g.innerHTML='<img src="assets/'+f[h]+'.webp" alt=""/>',c.appendChild(g)}if(c.style.transitionDuration="1s",c.style.transform=`translateY(-${b.clientHeight*(f.length-1)}px)`,b.replaceChild(c,i),!a){let e=b.parentElement.querySelector("#stars");null!==e&&b.parentElement.removeChild(e),(e=document.createElement("div")).style.position="absolute",e.style.display="none",e.id="stars";let j='<i class="fa-solid fa-star yellow-star"></i>'.repeat(d.rank);d.fiveStarGem&&(j+='<i class="fa-solid fa-star"></i>'.repeat(5-d.rank)),e.innerHTML=j,b.parentElement.appendChild(e)}}})}d.forEach(a=>{$(a).on("click",d=>{let a=$(d.target),b=a.hasClass("door-container")?a:a.parents(".door-container"),c=$(".boxes",b),e=$(".gem-info",b),f=c.attr("selected-gem");if("none"!==f){let g=e.clone();g.show();let h='<img src="assets/additional_info/'+c.attr("selected-gem")+'.jpg" class="modal-gem-info" style="display: block;" alt="">';$(".gem-info-modal-content").html(h),B.modal("show")}})});let C=(e,b,f)=>{let c=[],g=b.reduce((a,b)=>a+b),h=f/g;for(let a=0;a<e.length;++a){let i=h*b[a];for(let d=0;d<i;++d)c.push(a)}return c},D=a=>{let b=Math.floor(a.length*Math.random());return a[b]};function E(){let d=C(p,q,1e3),c=D(d);i&&(c=2,i=!1);let a="";switch(p[c]){case 1:return $("#one-star-count").text(++o["1"]),a=t[Math.floor(Math.random()*t.length)],m[1][a].amount++,{name:a,rank:1,fiveStarGem:!1};case 2:return $("#two-star-count").text(++o["2"]),a=u[Math.floor(Math.random()*u.length)],m[2][a].amount++,{name:a,rank:2,fiveStarGem:!1};case 5:let b=function(){let a=C(r,s,100),b=D(a);return r[b]}();switch(a=v[Math.floor(Math.random()*v.length)],m[b+"_5"][a].amount++,b){case 2:$("#two-of-five-star-count").text(++o["2_5"]);break;case 3:$("#three-star-count").text(++o["3_5"]);break;case 4:$("#four-star-count").text(++o["4_5"]);break;case 5:$("#five-star-count").text(++o["5_5"]),w.text(o["5_5"])}return{name:a,rank:b,fiveStarGem:!0}}}function F(){$("#total-gem-count").text(++n),$("#one-star-percentage").text(G(o["1"])),$("#two-star-percentage").text(G(o["2"])),$("#two-of-five-star-percentage").text(G(o["2_5"])),$("#three-star-percentage").text(G(o["3_5"])),$("#four-star-percentage").text(G(o["4_5"])),$("#five-star-percentage").text(G(o["5_5"]))}function G(a){return(a/n*100).toFixed(2)}function H(b){let a=0;return["2_5","3_5","4_5","5_5"].map(c=>{a+=m[c][b].amount}),a}function I(){$(".gem-upgrade-wrapper").each(e=>{let a=$(".gem-upgrade-wrapper")[e],b=$(".upgrade-gem-btn",a).attr("data-gem-name");if(!b)return;let c=$(".upgrade-gem-btn",a).attr("data-gem-stars"),d=0;d=["2_5","3_5","4_5","5_5"].includes(c)?H(b):m[c][b].amount,O(a,d,99)})}function J(c,d,b){let a=["2_5","3_5","4_5","5_5"];a.includes(b)&&a.map(a=>{if(0!==c){if(c-m[a][d].amount<0){m[a][d].amount=-((c-m[a][d].amount)*1),c=0;return}c-m[a][d].amount>=0&&(c-=m[a][d].amount,m[a][d].amount=0)}})}function K(a){A.text(k-=a)}function L(a,c,b){$(".gem-rank",a).text(b),$(".gem-rank-next",a).text(b+1)}function a(a){$(a.target).addClass("button-pressed")}function b(a){$(a.target).removeClass("button-pressed")}function M(a){for(let b in m[a])if(m[a][b].amount>0)return!0;return!1}function N(){let a="";return M("1")&&(a+='<option value="1">1 Star</option>'),M("2")&&(a+='<option value="2">2 Star</option>'),M("2_5")&&(a+='<option value="2_5">2/5 Star</option>'),M("3_5")&&(a+='<option value="3_5">3/5 Star</option>'),M("4_5")&&(a+='<option value="4_5">4/5 Star</option>'),M("5_5")&&(a+='<option value="5_5">5/5 Star</option>'),a=a?"<option selected>Select Star Rating</option>"+a:"<option selected>Not enough gems</option>"}function O(a,c,b){if(!b){$(".duplicates-wrapper",a).hide();return}if(99===b){$(".duplicates-available",a).text(c);return}$(".duplicates-wrapper",a).html('<span class="duplicates-available">'+c+"</span>/"+b+" Rank 1 duplicates"),$(".duplicates-wrapper",a).show()}function P(){let a="";Object.keys(m).reverse().forEach(c=>{for(let d in m[c]){let b="";switch(c){case"1":b='<i class="fa-solid fa-star yellow-star col"></i>';break;case"2":b='<i class="fa-solid fa-star yellow-star col"></i>'.repeat(2);break;case"2_5":b='<i class="fa-solid fa-star yellow-star col"></i>'.repeat(2)+'<i class="fa-solid fa-star col" style="color: white;"></i>'.repeat(3);break;case"3_5":b='<i class="fa-solid fa-star yellow-star col"></i>'.repeat(3)+'<i class="fa-solid fa-star col" style="color: white;"></i>'.repeat(2);break;case"4_5":b='<i class="fa-solid fa-star yellow-star col"></i>'.repeat(4)+'<i class="fa-solid fa-star col" style="color: white;"></i>'.repeat(1);break;case"5_5":b='<i class="fa-solid fa-star yellow-star col"></i>'.repeat(5)}m[c][d].amount>0&&(a+='<div class="inventory-content"><button data-gem-name="'+d+'" data-gem-stars="'+c+'" type="button" class="btn btn-xs consume-gem-btn" style="color: red; padding: 0; font-size: 14px !important;">Consume</button><img src="assets/gem_upgrade/'+d+'.webp" style="height: 40px; width: 40px; border-radius: 25px; display: inline" alt=""/><span>  '+m[c][d].name+" "+b+'</span><span class="inventory-gem-count"> x'+m[c][d].amount+"</span></div>")}}),$("#inventory-body").html(a)}if(window.matchMedia("(max-width: 1200px)").matches){let c=$("#stats-wrapper");$("#stats-modal-content").append(c.html()),c.remove()}else $("#statistics-tab").remove();$("#spin").on("click",e).on("mousedown",a).on("mouseup",b).on("touchstart",a),$("#auto-spin").on("click",f).on("mousedown",a).on("mouseup",b).on("touchstart",a),$("#paypal-button").on("mousedown",a).on("mouseup",b),$(".upgrade-gem-btn").on("click",function(e){let a=$(e.target),c=parseInt(a.attr("data-gem-rank")),d=a.attr("data-gem-stars"),b=function(c,b,a,d){if(d>9)return;let e=$(".gem-power-for-upgrade",c),f,g=["2_5","3_5","4_5","5_5"];switch(f=g.includes(a)?H(b):m[a][b].amount,a){case"1":switch(d){case 1:k>=1&&(K(1),L(c,b,++d,a),e.text(5));break;case 2:k>=5&&(K(5),L(c,b,++d,a),e.text(10));break;case 3:k>=10&&(K(10),L(c,b,++d,a),e.text(15));break;case 4:k>=15&&(K(15),L(c,b,++d,a),e.text(20));break;case 5:k>=20&&(K(20),L(c,b,++d,a),O(c,m[a][b].amount,1),e.text(25));break;case 6:k>=25&&f>=1&&(m[a][b].amount--,K(25),L(c,b,++d,a),e.text(30),O(c,m[a][b].amount,1));break;case 7:k>=30&&f>=1&&(m[a][b].amount--,K(30),L(c,b,++d,a),e.text(40),O(c,m[a][b].amount,1));break;case 8:k>=40&&f>=1&&(m[a][b].amount--,K(40),L(c,b,++d,a),e.text(50),O(c,m[a][b].amount,1));break;case 9:k>=50&&f>=1&&(m[a][b].amount--,K(50),L(c,b,++d,a),$(".gem-upgrade-requirements",c).hide(),$(".upgrade-gem-btn",c).hide(),$(".gem-upgrade-arrow",c).hide(),$(".gem-rank-next",c).hide())}break;case"2":switch(d){case 1:k>=5&&(K(1),e.text(15),L(c,b,++d,a));break;case 2:k>=15&&(K(15),e.text(25),O(c,m[a][b].amount,1),L(c,b,++d,a));break;case 3:f>=1&&k>=25&&(m[a][b].amount--,K(25),L(c,b,++d,a),e.text(20),O(c,m[a][b].amount,2));break;case 4:f>=2&&k>=25&&(m[a][b].amount-=2,K(20),L(c,b,++d,a),O(c,m[a][b].amount,5),e.text(85));break;case 5:f>=5&&k>=85&&(m[a][b].amount-=5,K(85),O(c,m[a][b].amount,5),e.text(85),L(c,b,++d,a));break;case 6:f>=5&&k>=85&&(m[a][b].amount-=5,K(25),e.text(105),O(c,m[a][b].amount,6),L(c,b,++d,a));break;case 7:f>=6&&k>=105&&(m[a][b].amount-=6,K(30),e.text(150),O(c,m[a][b].amount,9),L(c,b,++d,a));break;case 8:f>=9&&k>=150&&(m[a][b].amount-=9,K(40),e.text(195),O(c,m[a][b].amount,12),L(c,b,++d,a));break;case 9:f>=12&&k>=195&&(m[a][b].amount-=12,K(1),L(c,b,++d,a),$(".gem-upgrade-requirements",c).hide(),$(".upgrade-gem-btn",c).hide(),$(".gem-upgrade-arrow",c).hide(),$(".gem-rank-next",c).hide())}break;case"2_5":case"3_5":case"4_5":case"5_5":switch(d){case 1:k>=50&&(K(50),O(c,m[a][b].amount,1),e.text(75),L(c,b,++d,a));break;case 2:f>=1&&k>=75&&(J(1,b,a),K(75),e.text(100),O(c,m[a][b].amount,1),L(c,b,++d,a));break;case 3:f>=1&&k>=100&&(J(1,b,a),K(100),e.text(250),O(c,m[a][b].amount,5),L(c,b,++d,a));break;case 4:f>=5&&k>=250&&(J(5,b,a),K(250),O(c,m[a][b].amount,6),e.text(375),L(c,b,++d,a));break;case 5:f>=6&&k>=375&&(J(6,b,a),K(375),O(c,m[a][b].amount,12),e.text(725),L(c,b,++d,a));break;case 6:f>=12&&k>=725&&(J(12,b,a),K(725),e.text(725),O(c,m[a][b].amount,12),L(c,b,++d,a));break;case 7:f>=12&&k>=725&&(J(12,b,a),K(725),e.text(1075),O(c,m[a][b].amount,18),L(c,b,++d,a));break;case 8:f>=18&&k>=1075&&(J(18,b,a),K(1075),e.text(1075),O(c,m[a][b].amount,18),L(c,b,++d,a));break;case 9:f>=18&&k>=1075&&(J(18,b,a),K(1075),L(c,b,++d,a),$(".gem-upgrade-requirements",c).hide(),$(".upgrade-gem-btn",c).hide(),$(".gem-upgrade-arrow",c).hide(),$(".gem-rank-next",c).hide())}}return O(c,f=g.includes(a)?H(b):m[a][b].amount,99),d}($(a.parent().parent()),a.attr("data-gem-name"),d,c);if(a.attr("data-gem-rank",b),b>c)switch(d){case"1":z.text(j+=15);break;case"2":z.text(j+=30);break;case"2_5":b<4?z.text(j+=80):z.text(j+=90);break;case"3_5":b<3?z.text(j+=80):z.text(j+=90);break;case"4_5":z.text(j+=90);break;case"5_5":z.text(j+=100)}}).on("mousedown",a).on("mouseup",b).on("touchstart",a),$(".gem-select").on("change",function(f){let b=$(f.target),a=$(b.parent()),d=b.val(),g=$("option:selected",b).text(),e=$(".star-rating-select",a).val();b.css("background-image","none"),$(".gem-icon",a).attr("src","assets/"+d+".webp"),$(".gem-upgrade-wrapper",a).show(),b.attr("disabled","disabled"),$(".upgrade-gem-btn",a).attr("data-gem-name",d),$(".upgrade-gem-btn",a).attr("data-gem-stars",e),$(".star-rating-select",a).remove();let c=$(".gem-power-for-upgrade",a);switch(e){case"1":z.text(j+=15),c.text(1);break;case"2":z.text(j+=30),c.text(5);break;case"2_5":z.text(j+=30),c.text(50);break;case"3_5":z.text(j+=60),c.text(50);break;case"4_5":z.text(j+=90),c.text(50);break;case"5_5":z.text(j+=100),c.text(50)}m[e][d].amount>=1&&m[e][d].amount--,l.push(d),$(".gem-name",a).text(g),$(".gem-name",a).show(),b.remove()}),$(".star-rating-select").on("change",function(c){let b=$(c.target),a=$(b.parent());switch($(".gem-select",a).html(function(b){let c="";for(let a in m[b])!l.includes(a)&&m[b][a].amount>0&&(c+='<option value="'+a+'">'+m[b][a].name+"</option>");return"<option selected>Select a Legendary Gem</option>"+c}(b.val())),$(".gem-select",a).prop("disabled",!1),b.val()){case"1":$(".col-stars",a).html('<i class="fa-solid fa-star yellow-star col"></i>');break;case"2":$(".col-stars",a).html('<i class="fa-solid fa-star yellow-star col"></i>'.repeat(2));break;case"2_5":$(".col-stars",a).html('<i class="fa-solid fa-star yellow-star col"></i>'.repeat(2)+'<i class="fa-solid fa-star col" style="color: white;"></i>'.repeat(3));break;case"3_5":$(".col-stars",a).html('<i class="fa-solid fa-star yellow-star col"></i>'.repeat(3)+'<i class="fa-solid fa-star col" style="color: white;"></i>'.repeat(2));break;case"4_5":$(".col-stars",a).html('<i class="fa-solid fa-star yellow-star col"></i>'.repeat(4)+'<i class="fa-solid fa-star col" style="color: white;"></i>');break;case"5_5":$(".col-stars",a).html('<i class="fa-solid fa-star yellow-star col"></i>'.repeat(5))}}),$('img[data-bs-toggle="tab"]').on("shown.bs.tab",function(b){let a=$(b.target);a.css("filter","brightness(200%)"),"#inventory"===a.attr("href")&&P(),"#gem-upgrade"===a.attr("href")&&I(),$(".star-rating-select",$(a.attr("href"))).html(N())}).on("hidden.bs.tab",function(a){let b=$(a.target);b.css("filter","brightness(100%)")}),$(document.body).on("click",function(f){let c=$(f.target);if(c.hasClass("consume-gem-btn")){let e=$(c.parent()),a=c.attr("data-gem-stars"),b=c.attr("data-gem-name"),d;if(d="1"===a?1:"2"===a?4:32,x.prop("checked")?(A.text(k+=d*m[a][b].amount),m[a][b].amount=0):(m[a][b].amount--,A.text(k+=d)),0===m[a][b].amount){e.remove();return}$(".inventory-gem-count",e).text("x"+m[a][b].amount)}}),$(window).on("shown.bs.modal",function(){$(".star-rating-select").html(N()),P(),I()}),$(document).ready(()=>{$("#gem-upgrade-modal").modal({backdrop:"static",keyboard:!1})}),g()}()